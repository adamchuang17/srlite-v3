<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SimpleReceiveLite v4</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">

    <style>
        body {
            background: #1e1e2f;
            color: #fff;
            padding: 20px;
        }
        .toolbar {
            margin-bottom: 15px;
        }
        .card {
            background: #2c2c3c;
            margin-bottom: 10px;
            padding: 10px;
            border-radius: 5px;
        }
        .sig-link { display:none; }
        .sig-img { display:none; max-width:240px; margin-top:5px; }

        /* 列印專用樣式 */
        @media print {
            .toolbar, .btn { display:none !important; }
            body { background:#fff !important; color:#000 !important; }
            .card { box-shadow:none !important; background:#fff !important; }
            table { font-size:12px; }
            .sig-link { display:none !important; }
            .sig-img { display:block !important; max-width:240px; }
        }
    </style>
</head>
<body>
    <div class="toolbar">
        <button id="printPending" class="btn btn-success">列印待簽收</button>
        <button id="printSigned" class="btn btn-primary">列印已簽收</button>
    </div>

    <div id="content">
        <h3>待簽收清單</h3>
        <div id="pendingList"></div>

        <h3 class="mt-4">已簽收清單</h3>
        <div id="signedList"></div>
    </div>

    <script>
        const PENDING = "pending";
        const SIGNED = "signed";

        function save(key, data) {
            localStorage.setItem(key, JSON.stringify(data));
        }

        function load(key) {
            return JSON.parse(localStorage.getItem(key) || "[]");
        }

        function renderPending() {
            const list = load(PENDING);
            const div = document.getElementById("pendingList");
            div.innerHTML = "";
            list.forEach(item => {
                const card = document.createElement("div");
                card.className = "card";
                card.innerHTML = `<b>${item.name}</b> - ${item.note || ""}`;
                div.appendChild(card);
            });
        }

        function renderSigned() {
            const list = load(SIGNED);
            const div = document.getElementById("signedList");
            div.innerHTML = "";
            list.forEach(item => {
                const card = document.createElement("div");
                card.className = "card";
                card.innerHTML = `<b>${item.name}</b> - ${item.note || ""} <br>
                                  <img class="sig-img" src="${item.sign || ''}" alt="簽名">`;
                div.appendChild(card);
            });
        }

        // 列印功能
        document.getElementById("printPending").onclick = () => {
            window.print();
        };

        document.getElementById("printSigned").onclick = () => {
            window.print();
        };

        // 初始化
        if(!localStorage.getItem(PENDING)) save(PENDING, []);
        if(!localStorage.getItem(SIGNED)) save(SIGNED, []);
        renderPending();
        renderSigned();
    </script>
</body>
</html>
